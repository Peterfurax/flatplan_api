<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>lib.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#folioIdx">folioIdx</a></li><li><a href="global.html#parutionIdx">parutionIdx</a></li><li><a href="global.html#productIdx">productIdx</a></li><li><a href="global.html#productParution">productParution</a></li><li><a href="global.html#productParutionFolio">productParutionFolio</a></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">lib.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>"use strict";
// BASE SETUP
// =============================================================================
// - Call the packages we need
const dataFile = require('../provider/data');
const data = dataFile;
// INIT LIB
// =============================================================================
const lib = [];
// FUNCTION
// =============================================================================
// productIdx
// ----------
//     productIdx(product);
// Return Promise find index from `product:string`
/**
 * Return Promise find index from `product:string`
 * @method productIdx
 * @param  {string}   product [product]
 * @return {Promise}          [index product]
 * @example
 * productIdx(product)
 * .then(result=>{
 *   console.log(result); // index
 * })
 * .catch(err=>{
 *   console.log(err); // "lib.productIdx() => Product index not found "
 * });
 */
lib.productIdx = product => {
  return new Promise((resolve, reject) => {
    const productIdx = data.map((el) => el.produit)
      .indexOf(product);
    if (productIdx &lt; 0) {
      reject("lib.productIdx() => Product index not found ");
    }
    resolve(productIdx);
  });
};
// parutionIdx
// ----------
//     parutionIdx(productIdx, req);
// Return Promise find req.params.parution index from `productIdx:number`
/**
 * Return index parution for index product
 * @method parutionIdx
 * @param  {number}    productIdx [index product]
 * @param  {object}    req        [httprequest for inject req.params.parution]
 * @return {Promise}              [index parution]
 * @example
 * parutionIdx(productIdx(product), req)
 * .then(result=>{
 *   console.log(result); // index
 * })
 * .catch(err=>{
 *   console.log(err); // "lib.parutionIdx() => Parution index not found "
 * });
 */
lib.parutionIdx = (productIdx, req) => {
  return new Promise((resolve, reject) => {
    const parutIdx = data[productIdx].parution.map((el) => el.parution)
      .indexOf(req.params.parution);
    if (parutIdx &lt; 0) {
      reject("lib.parutionIdx() => Parution index not found ");
    }
    resolve(parutIdx);
  });
};
// folioIdx
// ----------
//     folioIdx(productIdx,parutionIdx, req);
// Return Promise find req.params.folio index from` `productIdx:number ` &amp;&amp; `parutionIdx:number `
/**
 * Return return index folio for index product &amp; index parution
 * @method folioIdx
 * @param  {number} productIdx  [index product]
 * @param  {number} parutionIdx [index parution]
 * @param  {object} req         [httprequest req.params.folio ]
 * @return {Promise}            [index folio]
 * @example
 * folioIdx(productIdx(product),parutionIdx(productIdx(product)), req)
 * .then(result=>{
 *   console.log(result); // index
 * })
 * .catch(err=>{
 *   console.log(err); // "lib.folioIdx() => folio index not found "
 * });
 */
lib.folioIdx = (productIdx, parutionIdx, req) => {
  return new Promise((resolve, reject) => {
    const folioIdx = data[productIdx].parution[parutionIdx].folio.map((el) => el.page)
      .indexOf(req.params.folio);
    if (folioIdx &lt; 0) {
      reject("lib.folioIdx() => folio index not found ");
    }
    resolve(folioIdx);
  });
};
// productParution
// ----------
//     productParution(req);
// Return Promise `{ 'productIdx': productIdx, 'parutionIdx': parutionIdx }`
/**
 * productParution return object with Product et Parution index
 * @method productParution
 * @param  {object}        req [request]
 * @return {Promise}           [{ 'productIdx': productIdx, 'parutionIdx': parutionIdx }]
 * @example
 * productParution(req)
 * .then(result=>{
 *   console.log(result); // { 'productIdx': productIdx, 'parutionIdx': parutionIdx }
 * })
 * .catch(err=>{
 *   console.log(err); // Promise.reject(err)
 * });
 */
lib.productParution = (req) => {
  return new Promise((resolve, reject) => {
    lib.productIdx(req.params.produit)
      .then(productIdx => {
        lib.parutionIdx(productIdx, req)
          .then(parutionIdx => {
            resolve({ 'productIdx': productIdx, 'parutionIdx': parutionIdx });
          })
          .catch(err => reject(err));
      })
      .catch(err => reject(err));
  });
};
// productParutionFolio
// ----------
//     productParutionFolio(req);
// Return Promise `{ 'productIdx': productIdx, 'parutionIdx': parutionIdx, 'folioIdx': folioIdx }`
/**
 * [productParutionFolio return object with Product &amp; Parution index &amp; Folio index]
 * @method productParutionFolio
 * @param  {object}        req [request]
 * @return {Promise}           [{ 'productIdx': productIdx, 'parutionIdx': parutionIdx, 'folioIdx': folioIdx }]
 * @example
 * productParutionFolio(req)
 * .then(result=>{
 *   console.log(result); // { 'productIdx': productIdx, 'parutionIdx': parutionIdx, 'folioIdx': folioIdx }
 * })
 * .catch(err=>{
 *   console.log(err); // Promise.reject(err)
 * });
 */
lib.productParutionFolio = (req) => {
  return new Promise((resolve, reject) => {
    lib.productIdx(req.params.produit)
      .then(productIdx => {
        lib.parutionIdx(productIdx, req)
          .then(parutionIdx => {
            lib.folioIdx(productIdx, parutionIdx, req)
              .then(folioIdx => {
                resolve({ 'productIdx': productIdx, 'parutionIdx': parutionIdx, 'folioIdx': folioIdx });
              })
              .catch(err => reject(err));
          })
          .catch(err => reject(err));
      })
      .catch(err => reject(err));
  });
};
// EXPORT LIB // DEBUG SUPPORT
// =============================================================================
module.exports = lib;
// if (require.resolve('mongoose')) reject('err : mongoose require ');
</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.3</a> on Fri Jan 20 2017 15:30:17 GMT+0100 (Paris, Madrid) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
