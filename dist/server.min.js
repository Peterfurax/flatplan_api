/*! flatplan_api - v1.0.0 - 2017-01-06 */"use strict";var express=require("express"),app=express(),bodyParser=require("body-parser");app.use(bodyParser.urlencoded({extended:!0})),app.use(bodyParser.json()),app.set("json spaces",2);var port=process.env.PORT||8e3,router=express.Router(),data=[{produit:"ewe",name:"Les Echos Weekend",parution:[{parution:"20160101",folio:[{page:"01",status:"locked",workflow:"bat"},{page:"02",status:"locked",workflow:"bat"}]},{parution:"20160102",folio:[{page:"01",status:"locked",workflow:"bat"},{page:"02",status:"locked",workflow:"bat"}]}]},{produit:"sli",name:"Serie LimitÃ©e",parution:[{parution:"20160101",folio:[{page:"01",status:"locked",workflow:"bat"},{page:"02",status:"locked",workflow:"bat"}]},{parution:"20160102",folio:[{page:"01",status:"locked",workflow:"bat"},{page:"02",status:"locked",workflow:"bat"}]}]}],productIdx=function(a){return new Promise(function(b,c){var d=data.map(function(a){return a.produit}).indexOf(a);d>0?b(d):c(d)})};router.get("/",function(a,b){b.json({message:"Welcome on flatplan_api !"})}),router.get("/produit/",function(a,b){b.json(data)}),router.get("/produit/:produit",function(a,b){productIdx(a.params.produit).then(function(a){b.json(data[a])},function(a){b.end()}).catch(function(a){})}),router.get("/produit/:produit/parution/",function(a,b){var c=data.map(function(a){return a.produit}).indexOf(a.params.produit);b.json(data[c].parution)}),router.get("/produit/:produit/parution/:parution",function(a,b){var c=data.map(function(a){return a.produit}).indexOf(a.params.produit),d=data[c].parution.map(function(a){return a.parution}).indexOf(a.params.parution);b.json(data[c].parution[d])}),router.get("/produit/:produit/parution/:parution/folio",function(a,b){var c=data.map(function(a){return a.produit}).indexOf(a.params.produit),d=data[c].parution.map(function(a){return a.parution}).indexOf(a.params.parution);b.json(data[c].parution[d].folio)}),router.get("/produit/:produit/parution/:parution/folio/:folio",function(a,b){var c=data.map(function(a){return a.produit}).indexOf(a.params.produit),d=data[c].parution.map(function(a){return a.parution}).indexOf(a.params.parution),e=data[c].parution[d].folio.map(function(a){return a.page}).indexOf(Number(a.params.folio));b.json(data[c].parution[d].folio[e])}),router.get("/produit/:produit/parution/:parution/folio/:folio/status",function(a,b){var c=data.map(function(a){return a.produit}).indexOf(a.params.produit),d=data[c].parution.map(function(a){return a.parution}).indexOf(a.params.parution),e=data[c].parution[d].folio.map(function(a){return a.page}).indexOf(Number(a.params.folio));b.json(data[c].parution[d].folio[e].status)}),app.use("/api",router),app.listen(port),module.exports=app;